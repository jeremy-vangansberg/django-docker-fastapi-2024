apiVersion: '2019-12-01'
location: francecentral
name: api_django
properties:
  containers:
    - name: postgresdb
      properties:
        image: postgres
        resources:
          requests:
            cpu: 1
            memoryInGb: 4
        ports:
          - port: 5432
        environmentVariables:
          - name: POSTGRES_DB
            value: demo_db
          - name: POSTGRES_PASSWORD
            value: 123
          - name: POSTGRES_USER
            value: myuser
          - name: POSTGRES_HOST
            value: postgresdb
          - name: POSTGRES_PORT
            value: 5432
    - name: web
      properties:
        image: j30v/django_2024 
        resources:
          requests:
            cpu: 1
            memoryInGb: 4
        ports:
          - port: 80
        environmentVariables:
          - name: SECRET_KEY
            value: w2oe0zyp1l!#xijync90im_t!uu_yzm(_dgai+9x189hqw9oi) 
          - name: URL_API
            value: http://localhost:8002/predict
          - name: DEBUG
            value: "0"
          - name: POSTGRES_DB
            value: demo_db
          - name: API_KEY
            value: 2c1e8ec8-f6e3-431a-8aa2-0b2d11327806
          - name: POSTGRES_PASSWORD
            value: "123"
          - name: POSTGRES_USER
            value: myuser
          - name: POSTGRES_HOST
            value: localhost
          - name: POSTGRES_PORT
            value: 5432
          - name: POSTGRES_RDY
            value: 1
          - name: SENDGRID_API_KEY
            value: 2a1dd2b3d727f9278e20e0b512f876df
    - name: api
      properties:
        image: j30v/api_2024 
        resources:
          requests:
            cpu: 1
            memoryInGb: 4
        ports:
          - port: 8002

  osType: Linux
  ipAddress:
    type: Public
    ports:
      - protocol: tcp
        port: 80  # Adapter en fonction des besoins de votre application
      # - protocol: tcp
      #   port: 8002  # Adapter en fonction des besoins de votre application
      # - protocol: tcp
      #   port: 5432  # Adapter en fonction des besoins de votre application
tags: null
type: Microsoft.ContainerInstance/containerGroups